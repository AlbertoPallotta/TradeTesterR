% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/performance_analysis.R
\name{analyze_performance}
\alias{analyze_performance}
\title{Analyze backtest performance (trade-level + time-series)}
\usage{
analyze_performance(
  bt,
  initial_equity = 10000,
  risk_free = NULL,
  scale = 252L,
  start = NULL,
  end = NULL,
  min_days_for_cagr = NULL
)
}
\arguments{
\item{bt}{A backtest object. Expected components:
\itemize{
  \item \code{$equity_curve} (optional): data.frame/data.table with a date/time column and an \code{Equity} column.
  \item \code{$results}: data.frame/data.table of completed trades with \code{EntryTime}, \code{ExitTime}, \code{Returns} (P\&L in currency).
}}

\item{initial_equity}{Numeric. Starting capital (default \code{10000}).}

\item{risk_free}{Either \emph{NULL} (assume 0), a single annualized numeric rate
(e.g. \code{0.03} = 3\%), or a data.frame/data.table with columns
\code{date} (or \code{Date}) and \code{rate} (or \code{adjusted}) as daily values
in decimal or percent (the function auto-scales if \code{>1}).}

\item{scale}{Integer trading days per year for annualization (default \code{252}).}

\item{start, end}{Optional \code{Date} (or character coercible) to restrict analysis window.}

\item{min_days_for_cagr}{Integer or NULL. If set (e.g. 180L), hide CAGR when the sample has fewer than this many trading days.}
}
\value{
A \code{data.table} with both trade-level and time-series metrics:
\itemize{
  \item \strong{Trade-level:} total_pnl, n_trades, win_rate, profit_factor, avg_win, avg_loss, expectancy,
        max_trade_dd (P\&L path on trade closes), win_loss_ratio.
  \item \strong{Time-series:} cagr, ann_vol, sharpe, sortino, max_dd, max_dd_pct, ulcer_index.
}
}
\description{
Computes robust performance metrics using the equity curve when available
(preferred for Sharpe/Sortino, CAGR, drawdowns), and complements them with
trade-level metrics (profit factor, win rate, expectancy, etc.).
}
\details{
Time-series metrics use \code{$equity_curve} if present; otherwise a step-wise
daily equity is built from summed P\&L at each \code{as.Date(ExitTime)}. This
approximation ignores mark-to-market between trade dates; use a true daily curve
for precise risk metrics.
}
\examples{
\dontrun{
# After you have a backtest object:
# bt <- my_test_strat(price)
metrics <- analyze_performance(bt, initial_equity = 10000, min_days_for_cagr = 180L)
print(metrics)
}

}
